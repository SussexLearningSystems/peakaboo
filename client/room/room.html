<template name="room_nav">
  <ul class="nav nav-pills">
    <li class="{{#if controls}}active{{/if}}"><a href="{{pathFor 'room_controls' _id=room._id}}" class="room_tab">Controls</a></li>
    <li class="{{#if repository}}active{{/if}}"><a href="{{pathFor 'room_repository' _id=room._id}}" class="room_tab">Repository</a></li>
  </ul>
  <hr>
</template>

<template name="controls">
  {{> room_nav}}
  <div class="row">
    <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">{{room.displayName}} {{#if room.recording}}<span class="label label-danger pull-right">Rec</span>{{/if}}</h3>
        </div>
        <div class="panel-body">
          <a href="#" class="thumbnail">
            {{#with room}}
            <img data-src="holder.js/100%" src="{{thumbnail}}">
            {{/with}}
          </a>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Audio</h3>
        </div>
        <div class="panel-body">
          {{#with room}}
          {{>vumeter}}
          {{/with}}
          <label>Rear Mic Boost</label><input type="range" class="audioFaders" name="rear-mic-boost" id="rearMicBoost" min="{{room.audio.rearMicBoost.limits.min}}" max="{{room.audio.rearMicBoost.limits.max}}" value={{room.audio.rearMicBoost.value.left}}>
          <label>Capture</label><input type="range" class="audioFaders" name="capture" id="capture" min="{{room.audio.capture.limits.min}}" max="{{room.audio.capture.limits.max}}" value={{room.audio.capture.value.left}}>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Controls</h3>
        </div>
        <div class="panel-body">
          <button type="button" data-toggle="modal" data-target="#mymodal" data-action="restart" data-title="Restart galicaster" data-message="Are you sure you want to restart galicaster on <b>{{room.displayName}}</b>?" data-confirm="Restart" class="btn btn-warning peakaboo-command">Restart galicaster</button>
          <button type="button" data-toggle="modal" data-target="#mymodal" data-action="reboot" data-title="Reboot machine" data-message="Are you sure you want to reboot <b>{{room.displayName}}</b>?" data-confirm="Reboot" class="btn btn-danger peakaboo-command">Reboot machine</button>
        </div>
      </div>
    </div>
  </div>
  {{>confirmModal}}
</template>

<template name="repository">
  {{> room_nav}}
  <div class="row">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Repository</h3>
        </div>
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Date</th><th>Name</th><th>Presenter</th><th>Series</th><th>Duration</th>
            </tr>
          </thead>
          <tbody>
          {{#each room.repository}}
            {{>tableRow}}
          {{/each}}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</template>

<template name="tableRow">
  <tr>
    <td>{{mcreated}}</td><td>{{title}}</td><td>{{creator}}</td><td>{{series_title}}</td><td>{{mduration}}</td>
  </tr>
</template>

<template name="confirmModal">
  <div id="mymodal" class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
          <h4 class="modal-title">{{modal.title}}</h4>
        </div>
        <div class="modal-body">
          <p>{{{modal.message}}}</p>
        </div>
        <div class="modal-footer">
          <button id="modalOk" type="button" class="btn btn-danger">{{modal.confirm}}</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>
</template>
